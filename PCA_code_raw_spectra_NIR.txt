/*Principal Component Analysis*/

/*Raw spectra code*/

ods html file='C:\Users\JAS\Desktop\raw_spectra.xls';
options nodate pageno=1;
data work.jasnir;
infile 'C:\Users\JAS\Desktop\raw_spectra.csv' delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=1 n=1500;
input Number$ Species$ MIT TOV MRML Tchar Tre Tmax 
w9994	w9984	w9974	w9964	w9954	w9944	w9934	w9924	w9914	w9904	w9894	w9884	w9874 
w9864	w9854	w9844	w9834	w9824	w9814	w9804	w9794	w9784	w9774	w9764	w9754	w9744
w9734	w9724	w9714	w9704	w9694	w9684	w9674	w9664	w9654	w9644	w9634	w9624	w9614
w9604	w9594	w9584	w9574	w9564	w9554	w9544	w9534	w9524	w9514	w9504	w9494	w9484
w9474	w9464	w9454	w9444	w9434	w9424	w9414	w9404	w9394	w9384	w9374	w9364	w9354
w9344	w9334	w9324	w9314	w9304	w9294	w9284	w9274	w9264	w9254	w9244	w9234	w9224
w9214	w9204	w9194	w9184	w9174	w9164	w9154	w9144	w9134	w9124	w9114	w9104	w9094
w9084	w9074	w9064	w9054	w9044	w9034	w9024	w9014	w9004	w8994	w8984	w8974	w8964
w8954	w8944	w8934	w8924	w8914	w8904	w8894	w8884	w8874	w8864	w8854	w8844	w8834
w8824	w8814	w8804	w8794	w8784	w8774	w8764	w8754	w8744	w8734	w8724	w8714	w8704
w8694	w8684	w8674	w8664	w8654	w8644	w8634	w8624	w8614	w8604	w8594	w8584	w8574
w8564	w8554	w8544	w8534	w8524	w8514	w8504	w8494	w8484	w8474	w8464	w8454	w8444
w8434	w8424	w8414	w8404	w8394	w8384	w8374	w8364	w8354	w8344	w8334	w8324	w8314
w8304	w8294	w8284	w8274	w8264	w8254	w8244	w8234	w8224	w8214	w8204	w8194	w8184
w8174	w8164	w8154	w8144	w8134	w8124	w8114	w8104	w8094	w8084	w8074	w8064	w8054
w8044	w8034	w8024	w8014	w8004	w7994	w7984	w7974	w7964	w7954	w7944	w7934	w7924
w7914	w7904	w7894	w7884	w7874	w7864	w7854	w7844	w7834	w7824	w7814	w7804	w7794
w7784	w7774	w7764	w7754	w7744	w7734	w7724	w7714	w7704	w7694	w7684	w7674	w7664
w7654	w7644	w7634	w7624	w7614	w7604	w7594	w7584	w7574	w7564	w7554	w7544	w7534
w7524	w7514	w7504	w7494	w7484	w7474	w7464	w7454	w7444	w7434	w7424	w7414	w7404
w7394	w7384	w7374	w7364	w7354	w7344	w7334	w7324	w7314	w7304	w7294	w7284	w7274
w7264	w7254	w7244	w7234	w7224	w7214	w7204	w7194	w7184	w7174	w7164	w7154	w7144
w7134	w7124	w7114	w7104	w7094	w7084	w7074	w7064	w7054	w7044	w7034	w7024	w7014
w7004	w6994	w6984	w6974	w6964	w6954	w6944	w6934	w6924	w6914	w6904	w6894	w6884
w6874	w6864	w6854	w6844	w6834	w6824	w6814	w6804	w6794	w6784	w6774	w6764	w6754
w6744	w6734	w6724	w6714	w6704	w6694	w6684	w6674	w6664	w6654	w6644	w6634	w6624
w6614	w6604	w6594	w6584	w6574	w6564	w6554	w6544	w6534	w6524	w6514	w6504	w6494
w6484	w6474	w6464	w6454	w6444	w6434	w6424	w6414	w6404	w6394	w6384	w6374	w6364
w6354	w6344	w6334	w6324	w6314	w6304	w6294	w6284	w6274	w6264	w6254	w6244	w6234
w6224	w6214	w6204	w6194	w6184	w6174	w6164	w6154	w6144	w6134	w6124	w6114	w6104
w6094	w6084	w6074	w6064	w6054	w6044	w6034	w6024	w6014	w6004	w5994	w5984	w5974
w5964	w5954	w5944	w5934	w5924	w5914	w5904	w5894	w5884	w5874	w5864	w5854	w5844
w5834	w5824	w5814	w5804	w5794	w5784	w5774	w5764	w5754	w5744	w5734	w5724	w5714
w5704	w5694	w5684	w5674	w5664	w5654	w5644	w5634	w5624	w5614	w5604	w5594	w5584
w5574	w5564	w5554	w5544	w5534	w5524	w5514	w5504	w5494	w5484	w5474	w5464	w5454
w5444	w5434	w5424	w5414	w5404	w5394	w5384	w5374	w5364	w5354	w5344	w5334	w5324
w5314	w5304	w5294	w5284	w5274	w5264	w5254	w5244	w5234	w5224	w5214	w5204	w5194
w5184	w5174	w5164	w5154	w5144	w5134	w5124	w5114	w5104	w5094	w5084	w5074	w5064
w5054	w5044	w5034	w5024	w5014	w5004	w4994	w4984	w4974	w4964	w4954	w4944	w4934
w4924	w4914	w4904	w4894	w4884	w4874	w4864	w4854	w4844	w4834	w4824	w4814	w4804
w4794	w4784	w4774	w4764	w4754	w4744	w4734	w4724	w4714	w4704	w4694	w4684	w4674
w4664	w4654	w4644	w4634	w4624	w4614	w4604	w4594	w4584	w4574	w4564	w4554	w4544
w4534	w4524	w4514	w4504	w4494	w4484	w4474	w4464	w4454	w4444	w4434	w4424	w4414
w4404	w4394	w4384	w4374	w4364	w4354	w4344	w4334	w4324	w4314	w4304	w4294	w4284
w4274	w4264	w4254	w4244	w4234	w4224	w4214	w4204	w4194	w4184	w4174	w4164	w4154
w4144	w4134	w4124	w4114	w4104	w4094	w4084	w4074	w4064	w4054	w4044	w4034	w4024
w4014	w4004;
datalines;
;
run;

proc princomp data=work.jasnir out=prinvars std;
var w9994	w9984	w9974	w9964	w9954	w9944	w9934	w9924	w9914	w9904	w9894	w9884	w9874 
w9864	w9854	w9844	w9834	w9824	w9814	w9804	w9794	w9784	w9774	w9764	w9754	w9744
w9734	w9724	w9714	w9704	w9694	w9684	w9674	w9664	w9654	w9644	w9634	w9624	w9614
w9604	w9594	w9584	w9574	w9564	w9554	w9544	w9534	w9524	w9514	w9504	w9494	w9484
w9474	w9464	w9454	w9444	w9434	w9424	w9414	w9404	w9394	w9384	w9374	w9364	w9354
w9344	w9334	w9324	w9314	w9304	w9294	w9284	w9274	w9264	w9254	w9244	w9234	w9224
w9214	w9204	w9194	w9184	w9174	w9164	w9154	w9144	w9134	w9124	w9114	w9104	w9094
w9084	w9074	w9064	w9054	w9044	w9034	w9024	w9014	w9004	w8994	w8984	w8974	w8964
w8954	w8944	w8934	w8924	w8914	w8904	w8894	w8884	w8874	w8864	w8854	w8844	w8834
w8824	w8814	w8804	w8794	w8784	w8774	w8764	w8754	w8744	w8734	w8724	w8714	w8704
w8694	w8684	w8674	w8664	w8654	w8644	w8634	w8624	w8614	w8604	w8594	w8584	w8574
w8564	w8554	w8544	w8534	w8524	w8514	w8504	w8494	w8484	w8474	w8464	w8454	w8444
w8434	w8424	w8414	w8404	w8394	w8384	w8374	w8364	w8354	w8344	w8334	w8324	w8314
w8304	w8294	w8284	w8274	w8264	w8254	w8244	w8234	w8224	w8214	w8204	w8194	w8184
w8174	w8164	w8154	w8144	w8134	w8124	w8114	w8104	w8094	w8084	w8074	w8064	w8054
w8044	w8034	w8024	w8014	w8004	w7994	w7984	w7974	w7964	w7954	w7944	w7934	w7924
w7914	w7904	w7894	w7884	w7874	w7864	w7854	w7844	w7834	w7824	w7814	w7804	w7794
w7784	w7774	w7764	w7754	w7744	w7734	w7724	w7714	w7704	w7694	w7684	w7674	w7664
w7654	w7644	w7634	w7624	w7614	w7604	w7594	w7584	w7574	w7564	w7554	w7544	w7534
w7524	w7514	w7504	w7494	w7484	w7474	w7464	w7454	w7444	w7434	w7424	w7414	w7404
w7394	w7384	w7374	w7364	w7354	w7344	w7334	w7324	w7314	w7304	w7294	w7284	w7274
w7264	w7254	w7244	w7234	w7224	w7214	w7204	w7194	w7184	w7174	w7164	w7154	w7144
w7134	w7124	w7114	w7104	w7094	w7084	w7074	w7064	w7054	w7044	w7034	w7024	w7014
w7004	w6994	w6984	w6974	w6964	w6954	w6944	w6934	w6924	w6914	w6904	w6894	w6884
w6874	w6864	w6854	w6844	w6834	w6824	w6814	w6804	w6794	w6784	w6774	w6764	w6754
w6744	w6734	w6724	w6714	w6704	w6694	w6684	w6674	w6664	w6654	w6644	w6634	w6624
w6614	w6604	w6594	w6584	w6574	w6564	w6554	w6544	w6534	w6524	w6514	w6504	w6494
w6484	w6474	w6464	w6454	w6444	w6434	w6424	w6414	w6404	w6394	w6384	w6374	w6364
w6354	w6344	w6334	w6324	w6314	w6304	w6294	w6284	w6274	w6264	w6254	w6244	w6234
w6224	w6214	w6204	w6194	w6184	w6174	w6164	w6154	w6144	w6134	w6124	w6114	w6104
w6094	w6084	w6074	w6064	w6054	w6044	w6034	w6024	w6014	w6004	w5994	w5984	w5974
w5964	w5954	w5944	w5934	w5924	w5914	w5904	w5894	w5884	w5874	w5864	w5854	w5844
w5834	w5824	w5814	w5804	w5794	w5784	w5774	w5764	w5754	w5744	w5734	w5724	w5714
w5704	w5694	w5684	w5674	w5664	w5654	w5644	w5634	w5624	w5614	w5604	w5594	w5584
w5574	w5564	w5554	w5544	w5534	w5524	w5514	w5504	w5494	w5484	w5474	w5464	w5454
w5444	w5434	w5424	w5414	w5404	w5394	w5384	w5374	w5364	w5354	w5344	w5334	w5324
w5314	w5304	w5294	w5284	w5274	w5264	w5254	w5244	w5234	w5224	w5214	w5204	w5194
w5184	w5174	w5164	w5154	w5144	w5134	w5124	w5114	w5104	w5094	w5084	w5074	w5064
w5054	w5044	w5034	w5024	w5014	w5004	w4994	w4984	w4974	w4964	w4954	w4944	w4934
w4924	w4914	w4904	w4894	w4884	w4874	w4864	w4854	w4844	w4834	w4824	w4814	w4804
w4794	w4784	w4774	w4764	w4754	w4744	w4734	w4724	w4714	w4704	w4694	w4684	w4674
w4664	w4654	w4644	w4634	w4624	w4614	w4604	w4594	w4584	w4574	w4564	w4554	w4544
w4534	w4524	w4514	w4504	w4494	w4484	w4474	w4464	w4454	w4444	w4434	w4424	w4414
w4404	w4394	w4384	w4374	w4364	w4354	w4344	w4334	w4324	w4314	w4304	w4294	w4284
w4274	w4264	w4254	w4244	w4234	w4224	w4214	w4204	w4194	w4184	w4174	w4164	w4154
w4144	w4134	w4124	w4114	w4104	w4094	w4084	w4074	w4064	w4054	w4044	w4034	w4024
w4014	w4004;
run;


proc reg data=prinvars outest=est press;
model TOV= prin1-prin10 / selection=stepwise vif p;
run;

proc print data=prinvars;
var prin1-prin10;
run;
ods html close;

/*First derivative code*/

ods html file='C:\Users\JAS\Desktop\first_derivative_output.xls';
options nodate pageno=1;
data work.jasfirstder;
infile 'C:\Users\JAS\Desktop\first_derivative_data.csv' delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=1 n=1500;
input Number$ Species$ MIT TOV MRML Tchar Tre Tmax 
w9994	w9984	w9974	w9964	w9954	w9944	w9934	w9924	w9914	w9904	w9894	w9884	w9874 
w9864	w9854	w9844	w9834	w9824	w9814	w9804	w9794	w9784	w9774	w9764	w9754	w9744
w9734	w9724	w9714	w9704	w9694	w9684	w9674	w9664	w9654	w9644	w9634	w9624	w9614
w9604	w9594	w9584	w9574	w9564	w9554	w9544	w9534	w9524	w9514	w9504	w9494	w9484
w9474	w9464	w9454	w9444	w9434	w9424	w9414	w9404	w9394	w9384	w9374	w9364	w9354
w9344	w9334	w9324	w9314	w9304	w9294	w9284	w9274	w9264	w9254	w9244	w9234	w9224
w9214	w9204	w9194	w9184	w9174	w9164	w9154	w9144	w9134	w9124	w9114	w9104	w9094
w9084	w9074	w9064	w9054	w9044	w9034	w9024	w9014	w9004	w8994	w8984	w8974	w8964
w8954	w8944	w8934	w8924	w8914	w8904	w8894	w8884	w8874	w8864	w8854	w8844	w8834
w8824	w8814	w8804	w8794	w8784	w8774	w8764	w8754	w8744	w8734	w8724	w8714	w8704
w8694	w8684	w8674	w8664	w8654	w8644	w8634	w8624	w8614	w8604	w8594	w8584	w8574
w8564	w8554	w8544	w8534	w8524	w8514	w8504	w8494	w8484	w8474	w8464	w8454	w8444
w8434	w8424	w8414	w8404	w8394	w8384	w8374	w8364	w8354	w8344	w8334	w8324	w8314
w8304	w8294	w8284	w8274	w8264	w8254	w8244	w8234	w8224	w8214	w8204	w8194	w8184
w8174	w8164	w8154	w8144	w8134	w8124	w8114	w8104	w8094	w8084	w8074	w8064	w8054
w8044	w8034	w8024	w8014	w8004	w7994	w7984	w7974	w7964	w7954	w7944	w7934	w7924
w7914	w7904	w7894	w7884	w7874	w7864	w7854	w7844	w7834	w7824	w7814	w7804	w7794
w7784	w7774	w7764	w7754	w7744	w7734	w7724	w7714	w7704	w7694	w7684	w7674	w7664
w7654	w7644	w7634	w7624	w7614	w7604	w7594	w7584	w7574	w7564	w7554	w7544	w7534
w7524	w7514	w7504	w7494	w7484	w7474	w7464	w7454	w7444	w7434	w7424	w7414	w7404
w7394	w7384	w7374	w7364	w7354	w7344	w7334	w7324	w7314	w7304	w7294	w7284	w7274
w7264	w7254	w7244	w7234	w7224	w7214	w7204	w7194	w7184	w7174	w7164	w7154	w7144
w7134	w7124	w7114	w7104	w7094	w7084	w7074	w7064	w7054	w7044	w7034	w7024	w7014
w7004	w6994	w6984	w6974	w6964	w6954	w6944	w6934	w6924	w6914	w6904	w6894	w6884
w6874	w6864	w6854	w6844	w6834	w6824	w6814	w6804	w6794	w6784	w6774	w6764	w6754
w6744	w6734	w6724	w6714	w6704	w6694	w6684	w6674	w6664	w6654	w6644	w6634	w6624
w6614	w6604	w6594	w6584	w6574	w6564	w6554	w6544	w6534	w6524	w6514	w6504	w6494
w6484	w6474	w6464	w6454	w6444	w6434	w6424	w6414	w6404	w6394	w6384	w6374	w6364
w6354	w6344	w6334	w6324	w6314	w6304	w6294	w6284	w6274	w6264	w6254	w6244	w6234
w6224	w6214	w6204	w6194	w6184	w6174	w6164	w6154	w6144	w6134	w6124	w6114	w6104
w6094	w6084	w6074	w6064	w6054	w6044	w6034	w6024	w6014	w6004	w5994	w5984	w5974
w5964	w5954	w5944	w5934	w5924	w5914	w5904	w5894	w5884	w5874	w5864	w5854	w5844
w5834	w5824	w5814	w5804	w5794	w5784	w5774	w5764	w5754	w5744	w5734	w5724	w5714
w5704	w5694	w5684	w5674	w5664	w5654	w5644	w5634	w5624	w5614	w5604	w5594	w5584
w5574	w5564	w5554	w5544	w5534	w5524	w5514	w5504	w5494	w5484	w5474	w5464	w5454
w5444	w5434	w5424	w5414	w5404	w5394	w5384	w5374	w5364	w5354	w5344	w5334	w5324
w5314	w5304	w5294	w5284	w5274	w5264	w5254	w5244	w5234	w5224	w5214	w5204	w5194
w5184	w5174	w5164	w5154	w5144	w5134	w5124	w5114	w5104	w5094	w5084	w5074	w5064
w5054	w5044	w5034	w5024	w5014	w5004	w4994	w4984	w4974	w4964	w4954	w4944	w4934
w4924	w4914	w4904	w4894	w4884	w4874	w4864	w4854	w4844	w4834	w4824	w4814	w4804
w4794	w4784	w4774	w4764	w4754	w4744	w4734	w4724	w4714	w4704	w4694	w4684	w4674
w4664	w4654	w4644	w4634	w4624	w4614	w4604	w4594	w4584	w4574	w4564	w4554	w4544
w4534	w4524	w4514	w4504	w4494	w4484	w4474	w4464	w4454	w4444	w4434	w4424	w4414
w4404	w4394	w4384	w4374	w4364	w4354	w4344	w4334	w4324	w4314	w4304	w4294	w4284
w4274	w4264	w4254	w4244	w4234	w4224	w4214	w4204	w4194	w4184	w4174	w4164	w4154
w4144	w4134	w4124	w4114	w4104	w4094	w4084	w4074	w4064	w4054	w4044	w4034	w4024
w4014;
datalines;
;
run;

proc princomp data=work.jasfirstder out=prinvars std;
var w9994	w9984	w9974	w9964	w9954	w9944	w9934	w9924	w9914	w9904 w9894	w9884	w9874 
w9864	w9854	w9844	w9834	w9824	w9814	w9804	w9794	w9784	w9774	w9764	w9754	w9744
w9734	w9724	w9714	w9704	w9694	w9684	w9674	w9664	w9654	w9644	w9634	w9624	w9614
w9604	w9594	w9584	w9574	w9564	w9554	w9544	w9534	w9524	w9514	w9504	w9494	w9484
w9474	w9464	w9454	w9444	w9434	w9424	w9414	w9404	w9394	w9384	w9374	w9364	w9354
w9344	w9334	w9324	w9314	w9304	w9294	w9284	w9274	w9264	w9254	w9244	w9234	w9224
w9214	w9204	w9194	w9184	w9174	w9164	w9154	w9144	w9134	w9124	w9114	w9104	w9094
w9084	w9074	w9064	w9054	w9044	w9034	w9024	w9014	w9004	w8994	w8984	w8974	w8964
w8954	w8944	w8934	w8924	w8914	w8904	w8894	w8884	w8874	w8864	w8854	w8844	w8834
w8824	w8814	w8804	w8794	w8784	w8774	w8764	w8754	w8744	w8734	w8724	w8714	w8704
w8694	w8684	w8674	w8664	w8654	w8644	w8634	w8624	w8614	w8604	w8594	w8584	w8574
w8564	w8554	w8544	w8534	w8524	w8514	w8504	w8494	w8484	w8474	w8464	w8454	w8444
w8434	w8424	w8414	w8404	w8394	w8384	w8374	w8364	w8354	w8344	w8334	w8324	w8314
w8304	w8294	w8284	w8274	w8264	w8254	w8244	w8234	w8224	w8214	w8204	w8194	w8184
w8174	w8164	w8154	w8144	w8134	w8124	w8114	w8104	w8094	w8084	w8074	w8064	w8054
w8044	w8034	w8024	w8014	w8004	w7994	w7984	w7974	w7964	w7954	w7944	w7934	w7924
w7914	w7904	w7894	w7884	w7874	w7864	w7854	w7844	w7834	w7824	w7814	w7804	w7794
w7784	w7774	w7764	w7754	w7744	w7734	w7724	w7714	w7704	w7694	w7684	w7674	w7664
w7654	w7644	w7634	w7624	w7614	w7604	w7594	w7584	w7574	w7564	w7554	w7544	w7534
w7524	w7514	w7504	w7494	w7484	w7474	w7464	w7454	w7444	w7434	w7424	w7414	w7404
w7394	w7384	w7374	w7364	w7354	w7344	w7334	w7324	w7314	w7304	w7294	w7284	w7274
w7264	w7254	w7244	w7234	w7224	w7214	w7204	w7194	w7184	w7174	w7164	w7154	w7144
w7134	w7124	w7114	w7104	w7094	w7084	w7074	w7064	w7054	w7044	w7034	w7024	w7014
w7004	w6994	w6984	w6974	w6964	w6954	w6944	w6934	w6924	w6914	w6904	w6894	w6884
w6874	w6864	w6854	w6844	w6834	w6824	w6814	w6804	w6794	w6784	w6774	w6764	w6754
w6744	w6734	w6724	w6714	w6704	w6694	w6684	w6674	w6664	w6654	w6644	w6634	w6624
w6614	w6604	w6594	w6584	w6574	w6564	w6554	w6544	w6534	w6524	w6514	w6504	w6494
w6484	w6474	w6464	w6454	w6444	w6434	w6424	w6414	w6404	w6394	w6384	w6374	w6364
w6354	w6344	w6334	w6324	w6314	w6304	w6294	w6284	w6274	w6264	w6254	w6244	w6234
w6224	w6214	w6204	w6194	w6184	w6174	w6164	w6154	w6144	w6134	w6124	w6114	w6104
w6094	w6084	w6074	w6064	w6054	w6044	w6034	w6024	w6014	w6004	w5994	w5984	w5974
w5964	w5954	w5944	w5934	w5924	w5914	w5904	w5894	w5884	w5874	w5864	w5854	w5844
w5834	w5824	w5814	w5804	w5794	w5784	w5774	w5764	w5754	w5744	w5734	w5724	w5714
w5704	w5694	w5684	w5674	w5664	w5654	w5644	w5634	w5624	w5614	w5604	w5594	w5584
w5574	w5564	w5554	w5544	w5534	w5524	w5514	w5504	w5494	w5484	w5474	w5464	w5454
w5444	w5434	w5424	w5414	w5404	w5394	w5384	w5374	w5364	w5354	w5344	w5334	w5324
w5314	w5304	w5294	w5284	w5274	w5264	w5254	w5244	w5234	w5224	w5214	w5204	w5194
w5184	w5174	w5164	w5154	w5144	w5134	w5124	w5114	w5104	w5094	w5084	w5074	w5064
w5054	w5044	w5034	w5024	w5014	w5004	w4994	w4984	w4974	w4964	w4954	w4944	w4934
w4924	w4914	w4904	w4894	w4884	w4874	w4864	w4854	w4844	w4834	w4824	w4814	w4804
w4794	w4784	w4774	w4764	w4754	w4744	w4734	w4724	w4714	w4704	w4694	w4684	w4674
w4664	w4654	w4644	w4634	w4624	w4614	w4604	w4594	w4584	w4574	w4564	w4554	w4544
w4534	w4524	w4514	w4504	w4494	w4484	w4474	w4464	w4454	w4444	w4434	w4424	w4414
w4404	w4394	w4384	w4374	w4364	w4354	w4344	w4334	w4324	w4314	w4304	w4294	w4284
w4274	w4264	w4254	w4244	w4234	w4224	w4214	w4204	w4194	w4184	w4174	w4164	w4154
w4144	w4134	w4124	w4114	w4104	w4094	w4084	w4074	w4064	w4054	w4044	w4034	w4024
w4014;
run;


proc reg data=prinvars outest=est press;
model TOV= prin1-prin10 / selection=stepwise vif p;
run;

proc print data=prinvars;
var prin1-prin10;
run;
ods html close;
